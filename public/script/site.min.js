$(function(){babyFeeds.init(),$(document).on("mozvisibilitychange visibilitychange",function(){"visible"===(document.visibilityState||document.webkitVisibilityState)&&babyFeeds.init()})});var babyFeeds={init:function(){babyFeeds.ui.updateFeedVolumeLabel(),$("#input-feed-volume").off().bind("input",babyFeeds.ui.updateFeedVolumeLabel),$("#button-feed-save").prop("disabled",!1),$("#button-feed-save").off().click(babyFeeds.userActions.saveFeed),babyFeeds.server.load(function(o){console.log(o),$("#bottle-area").show(),$("#feed-area").show(),babyFeeds.ui.buildTimeInput(),babyFeeds.ui.buildHistoryCalendars();var d=0,r="",s=138,l=s-27;$(o.feedsForToday).each(function(e,t){d+=t.Milliliters;var i=t.Milliliters/o.feedRequiredForToday,a=s-l*i,n=l*i;s-=n,r+='<rect class="bottle-fill-'+(e%2+1)+'" y="'+a+'" width="75" height="'+n+'"/>'}),$("#bottle-fills").html(r);var e=o.feedRequiredForToday-d;if(0<e)$("#remaining-today-area span").text(e);else{$("#remaining-today-area").hide();var t=0,i=function(){t++%2?$("#bottle-overflow").show():$("#bottle-overflow").hide(),t<8&&window.setTimeout(i,500)};i()}$(o.feedTotalsPerDay).each(function(e,t){for(var i=moment(t.Date).format("MM/DD/YYYY"),a=t.Percent,n=10,o=1,d=70;d<110;d+=5){if(a<d){n=o;break}o++}$(".day[data-day="+i.replace(/\//g,"\\/")+"]:not(.old,.new)").addClass("tier"+n).text(a+"%")})})},ui:{buildTimeInput:function(){$("#input-feed-time").datetimepicker({inline:!0,format:"LT"}),$("#input-feed-time .timepicker button").removeClass("btn").removeClass("btn-primary"),$("#input-feed-time .timepicker-picker table.table-condensed tr:first").hide(),$("#input-feed-time .timepicker-picker table.table-condensed tr:nth-child(3)").hide(),$("#input-feed-time").datetimepicker("date",moment())},buildHistoryCalendars:function(){$("#input-history-last-month").datetimepicker({inline:!0,date:moment().subtract(1,"months").format("YYYY-MM-DD")}),$("#input-history-current-month").datetimepicker({inline:!0,date:moment().format("YYYY-MM-DD")}),$(".datepicker .picker-switch").attr("colspan",7).attr("data-action",""),$(".datepicker .old").text(""),$(".datepicker .new").text(""),$(".datepicker .day").attr("data-action","").removeClass("active").removeClass("today").removeClass(function(e,t){return(t.match(/(^|\s)tier\S+/g)||[]).join(" ")}).text("")},updateFeedVolumeLabel:function(){$("#label-feed-volume span").html($("#input-feed-volume").val())}},userActions:{saveFeed:function(e){e.preventDefault(),$("#button-feed-save").prop("disabled",!0);var t=moment().format("YYYY-MM-DD");if(parseInt($("#input-feed-time").datetimepicker("date").format("HH"))-2>moment().hours())t=moment().subtract(1,"days").format("YYYY-MM-DD");t+=" "+$("#input-feed-time").datetimepicker("date").format("HH:mm");var i=$("#input-feed-volume").val();babyFeeds.server.saveFeed(t,i,function(){babyFeeds.init()})}},server:{load:function(e){$.ajax({type:"GET",url:"/api/load",contentType:"application/json",success:e})},saveFeed:function(e,t,i){$.ajax({type:"POST",url:"/api/savefeed",data:JSON.stringify({dateTime:e,milliliters:t}),contentType:"application/json",success:i})}}};
//# sourceMappingURL=site.min.js.map